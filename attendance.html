<!DOCTYPE html>
<html dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØºÙŠØ§Ø¨ ÙˆØ§Ù„ØªØ§Ø®ÙŠØ±</title>
    <link rel="icon" type="image/png" href="Ø´Ø¹Ø§Ø±_ÙˆØ²Ø§Ø±Ø©_Ø§Ù„ØªØ¹Ù„ÙŠÙ….png">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin: 20px 0;
            table-layout: fixed; /* Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯Ø© */
        }
        th, td {
    padding: 8px;
    text-align: center;
    border: 1px solid #ddd;
    overflow: hidden;
    text-overflow: ellipsis;
}

        /* ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© */
       table th:nth-child(1),
table td:nth-child(1) {
    width: 20px;
    min-width: 20px;
}

/* Ø¹Ù…ÙˆØ¯ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù… */
table th:nth-child(2),
table td:nth-child(2) {
    width: 250px;
    min-width: 250px;
    text-align: right;
}

/* Ø¹Ù…ÙˆØ¯ Ø§Ù„ØºÙŠØ§Ø¨ (Ø£ÙŠØ§Ù…) */
table th:nth-child(3),
table td:nth-child(3) {
    width: 50px;
    min-width: 50px;
}

/* Ø¹Ù…ÙˆØ¯ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØºÙŠØ§Ø¨ */
table th:nth-child(4),
table td:nth-child(4) {
    width: 100px;
    min-width: 100px;
}

/* Ø¹Ù…ÙˆØ¯ ØªØ£Ø®ÙŠØ± (Ø¯Ù‚Ø§Ø¦Ù‚) */
table th:nth-child(5),
table td:nth-child(5) {
    width: 80px;
    min-width: 80px;
}

/* Ø¹Ù…ÙˆØ¯ ØªØ£Ø®ÙŠØ± (Ø³Ø§Ø¹Ø§Øª) */
table th:nth-child(6),
table td:nth-child(6) {
    width: 80px;
    min-width: 80px;
}
/* Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ù‚Ø³Ù… <style> */
.delay-warning {
    color: red;
    font-weight: bold;
}


/* Ø¹Ù…ÙˆØ¯ ØªØ£Ø®ÙŠØ± (Ø£ÙŠØ§Ù…) */
table th:nth-child(7),
table td:nth-child(7) {
    width: 80px;
    min-width: 80px;
}

/* Ø¹Ù…ÙˆØ¯ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªØ£Ø®ÙŠØ± */
table th:nth-child(8),
table td:nth-child(8) {
    width: 100px;
    min-width: 100px;
}

/* Ø¹Ù…ÙˆØ¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ */
table th:nth-child(9),
table td:nth-child(9) {
    width: 100px;
    min-width: 100px;
}


        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù… */
        table th:nth-child(2),
        table td:nth-child(2) {
            min-width: 200px;
            text-align: right;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
        table th:last-child,
table td:last-child {
    width: 200px;
    min-width: 200px;
    white-space: normal;
}
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background-color: #f2f2f2;
        }
        .rating-5 { color: #27ae60; }
        .rating-4 { color: #2ecc71; }
        .rating-3 { color: #f1c40f; }
        .rating-2 { color: #e67e22; }
        .rating-1 { color: #e74c3c; }
        .button {
            background-color: #3498db;
            color: white;
            padding: 6px 12px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            margin: 2px;
            min-width: 80px;
            font-size: 13px;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        td .button {
    padding: 4px 8px;
    margin: 2px;
    font-size: 12px;
    display: inline-block;
}
        .edit-button { background-color: #3498db; }
        .delete-button { background-color: #e74c3c; }
        .save-button { background-color: #27ae60; }
        .print-button { background-color: #8e44ad; }
        .button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        input {
            padding: 8px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 8px;
            background-color: white;
            padding: 12px;
            border-radius: 6px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.1);
        }
        .input-group {
    display: flex;
    align-items: center;
    gap: 15px; /* Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù†Ø§ØµØ± */
    margin-bottom: 20px;
}
#absenceDays,
#delayMinutes {
    width: 100px;
    text-align: center;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
}
        .import-btn {
            position: relative;
            cursor: pointer;
        }
        .editable-cell input {
            width: 80px;
        }
        @media print {
            .no-print {
                display: none;
            }
        }
input[type="number"] {
    width: 100%;
    padding: 4px;
    border: 1px solid #ddd;
    border-radius: 4px;
    text-align: center;
    -moz-appearance: textfield;
}

input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
    -webkit-appearance: auto;
    margin: 0;
}
    </style>


</head>
<body>
    <div class="container">
        <h1>Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØºÙŠØ§Ø¨ ÙˆØ§Ù„ØªØ§Ø®ÙŠØ±</h1>
        
        <div class="controls no-print">
            <div class="input-group">
                <input type="text" id="teacherName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…">
                <input type="number" id="absenceDays" placeholder="Ø£ÙŠØ§Ù… Ø§Ù„ØºÙŠØ§Ø¨">
                <input type="number" id="delayMinutes" placeholder="Ø¯Ù‚Ø§Ø¦Ù‚ Ø§Ù„ØªØ£Ø®ÙŠØ±">
                <button class="button" onclick="addTeacher()">Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…</button>
            </div>
            <div class="action-buttons">
                <button class="button print-button" onclick="printAllStats()">Ø·Ø¨Ø§Ø¹Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
 <button class="button delete-button" onclick="deleteAllData()">Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                <button class="button" onclick="exportToJSON()">ØªØµØ¯ÙŠØ± JSON</button>
                <label class="button import-btn">
                    Ø§Ø³ØªÙŠØ±Ø§Ø¯ JSON
                    <input type="file" id="importFile" onchange="importFromJSON()" style="display: none">
                </label>
                <button class="button" onclick="importNamesFromMain()">Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ù…Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
                <button class="button" onclick="location.href='main.html'">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
            </div>
        </div>

        <table id="teachersTable">
            <thead>
    <tr>
        <th>Ù…</th>
        <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</th>
        <th>Ø§Ù„ØºÙŠØ§Ø¨ (Ø£ÙŠØ§Ù…)</th>
        <th>ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØºÙŠØ§Ø¨</th>
        <th>ØªØ£Ø®ÙŠØ± (Ø¯Ù‚Ø§Ø¦Ù‚)</th>
        <th>ØªØ£Ø®ÙŠØ± (Ø³Ø§Ø¹Ø§Øª)</th>
        <th>ØªØ£Ø®ÙŠØ± (Ø£ÙŠØ§Ù…)</th>
        <th>ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªØ£Ø®ÙŠØ±</th>
        <th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</th>
        <th class="no-print">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
    </tr>
</thead>
            <tbody id="teachersBody">
            </tbody>
        </table>
    </div>
<script>
    let teachers = [];
    let counter = 1;
function showInstructions() {
        const message = `
        ğŸ¯ Ø¢Ù„ÙŠØ© Ø§Ø­ØªØ³Ø§Ø¨ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:

        ğŸ“Š ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØºÙŠØ§Ø¨:
        â€¢ 0 ÙŠÙˆÙ… ØºÙŠØ§Ø¨ = 5 Ø¯Ø±Ø¬Ø§Øª
        â€¢ 1 ÙŠÙˆÙ… ØºÙŠØ§Ø¨ = 4 Ø¯Ø±Ø¬Ø§Øª
        â€¢ 2 ÙŠÙˆÙ… ØºÙŠØ§Ø¨ = 3 Ø¯Ø±Ø¬Ø§Øª
        â€¢ 3 ÙŠÙˆÙ… ØºÙŠØ§Ø¨ = Ø¯Ø±Ø¬ØªØ§Ù†
        â€¢ 4 Ø£ÙŠØ§Ù… Ø£Ùˆ Ø£ÙƒØ«Ø± = Ø¯Ø±Ø¬Ø© ÙˆØ§Ø­Ø¯Ø©

        â° ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªØ£Ø®ÙŠØ±:
        â€¢ Ø£Ù‚Ù„ Ù…Ù† 7 Ø³Ø§Ø¹Ø§Øª (419 Ø¯Ù‚ÙŠÙ‚Ø© Ø£Ùˆ Ø£Ù‚Ù„) = 5 Ø¯Ø±Ø¬Ø§Øª
        â€¢ Ù…Ù† 7 Ø¥Ù„Ù‰ 14 Ø³Ø§Ø¹Ø© (420-839 Ø¯Ù‚ÙŠÙ‚Ø©) = 4 Ø¯Ø±Ø¬Ø§Øª
        â€¢ Ù…Ù† 14 Ø¥Ù„Ù‰ 21 Ø³Ø§Ø¹Ø© (840-1259 Ø¯Ù‚ÙŠÙ‚Ø©) = 3 Ø¯Ø±Ø¬Ø§Øª
        â€¢ Ù…Ù† 21 Ø¥Ù„Ù‰ 28 Ø³Ø§Ø¹Ø© (1260-1679 Ø¯Ù‚ÙŠÙ‚Ø©) = Ø¯Ø±Ø¬ØªØ§Ù†
        â€¢ 28 Ø³Ø§Ø¹Ø© ÙØ£ÙƒØ«Ø± (1680 Ø¯Ù‚ÙŠÙ‚Ø© ÙØ£ÙƒØ«Ø±) = Ø¯Ø±Ø¬Ø© ÙˆØ§Ø­Ø¯Ø©

        ğŸ¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:
        â€¢ ÙŠØªÙ… Ø§Ø­ØªØ³Ø§Ø¨ Ø§Ù„Ù…ØªÙˆØ³Ø· Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠ Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØºÙŠØ§Ø¨ ÙˆØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªØ£Ø®ÙŠØ±
        â€¢ Ù…Ø«Ø§Ù„: Ø¥Ø°Ø§ ÙƒØ§Ù† ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØºÙŠØ§Ø¨ 4 ÙˆØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªØ£Ø®ÙŠØ± 5ØŒ ÙØ¥Ù† Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ = (4+5)/2 = 4.5 ÙˆÙŠØªÙ… ØªÙ‚Ø±ÙŠØ¨Ù‡ Ø¥Ù„Ù‰ 5 (ÙŠØªÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù„Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„ØµØ§Ù„Ø­ Ø§Ù„Ù…Ø¹Ù„Ù…)
        `;

        const popup = document.createElement('div');
        popup.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
            z-index: 1000;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            direction: rtl;
            font-family: Arial;
            white-space: pre-line;
            line-height: 1.5;
        `;

        popup.innerHTML = `
            <h2 style="color: #3498db; text-align: center; margin-bottom: 20px;">Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</h2>
            <div style="margin-bottom: 20px;">${message}</div>
            <button onclick="this.parentElement.remove()" style="
                background: #3498db;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                display: block;
                margin: 0 auto;
            ">ÙÙ‡Ù…Øª</button>
        `;

        document.body.appendChild(popup);
    }


   function calculateRating(absenceDays, delayMinutes) {
    let absenceScore = 5;
    if (absenceDays === 1) absenceScore = 4;
    else if (absenceDays === 2) absenceScore = 3;
    else if (absenceDays === 3) absenceScore = 2;
    else if (absenceDays >= 4) absenceScore = 1;

    let delayScore = 5;
    if (delayMinutes >= 420 && delayMinutes < 840) delayScore = 4;
    else if (delayMinutes >= 840 && delayMinutes < 1260) delayScore = 3;
    else if (delayMinutes >= 1260 && delayMinutes < 1680) delayScore = 2;
    else if (delayMinutes >= 1680) delayScore = 1;

    const average = (absenceScore + delayScore) / 2;
    return Math.ceil(average); // Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ Ù„Ù„Ø£Ø¹Ù„Ù‰
}

    // Ø­Ø³Ø§Ø¨ ÙˆØ­Ø¯Ø§Øª Ø§Ù„ØªØ£Ø®ÙŠØ±
    function calculateDelayUnits(minutes) {
        const hours = Math.floor(minutes / 60);
        const days = Math.floor(hours / 24);
        return {
            hours: hours,
            days: days
        };
    }

    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    fetch('data/teachers-data.json')
  .then(response => response.json())
  .then(data => {
    teachers = data; // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù…ØªØºÙŠØ± teachers
    updateTable(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  })
  .catch(error => console.error('Ø­Ø¯Ø« Ø®Ø·Ø£:', error));
// Ø£Ø¶Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© ÙÙŠ Ù‚Ø³Ù… JavaScript
function deleteAllData() {
    if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.')) {
        teachers = [];
        counter = 1;
        updateTable();
        saveToLocalStorage();
        alert('ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
    }
}


    // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…
    function addTeacher() {
        const name = document.getElementById('teacherName').value;
        const absenceDays = parseInt(document.getElementById('absenceDays').value) || 0;
        const delayMinutes = parseInt(document.getElementById('delayMinutes').value) || 0;

        if (!name) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…');
            return;
        }

        const delayUnits = calculateDelayUnits(delayMinutes);
        const rating = calculateRating(absenceDays, delayMinutes);

        const teacher = {
            id: counter++,
            name: name,
            absenceDays: absenceDays,
            delayMinutes: delayMinutes,
            delayHours: delayUnits.hours,
            delayDays: delayUnits.days,
            rating: rating
        };

        teachers.push(teacher);
        sortTeachersAlphabetically();
        updateTable();
        clearInputs();
        saveToLocalStorage();
    }
function sortTeachersAlphabetically() {
    teachers.sort((a, b) => a.name.localeCompare(b.name, 'ar'));
}

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„
    function updateTable() {
    const tbody = document.getElementById('teachersBody');
    tbody.innerHTML = '';

    teachers.forEach((teacher, index) => {
        const absenceScore = calculateAbsenceScore(teacher.absenceDays);
        const delayScore = calculateDelayScore(teacher.delayMinutes);
        const finalRating = Math.ceil((absenceScore + delayScore) / 2);

        const delayHoursClass = teacher.delayHours >= 7 ? 'delay-warning' : '';

        const row = document.createElement('tr');
        row.setAttribute('data-id', teacher.id);
        row.innerHTML = `
            <td>${index + 1}</td>
            <td>${teacher.name}</td>
            <td>${teacher.absenceDays}</td>
            <td class="rating-${absenceScore}">${absenceScore} Ù…Ù† 5</td>
            <td>${teacher.delayMinutes}</td>
            <td class="${delayHoursClass}">${teacher.delayHours}</td>
            <td>${teacher.delayDays}</td>
            <td class="rating-${delayScore}">${delayScore} Ù…Ù† 5</td>
            <td class="rating-${finalRating}">${finalRating} Ù…Ù† 5</td>
            <td class="no-print">
                <button class="button edit-button" onclick="editTeacherName(${teacher.id})">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…</button>
                <button class="button edit-button" onclick="editTeacher(${teacher.id})">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚ÙŠÙ…</button>
                <button class="button delete-button" onclick="deleteTeacher(${teacher.id})">Ø­Ø°Ù</button>
                <button class="button print-button" onclick="printAbsenceStats(${teacher.id})">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØºÙŠØ§Ø¨</button>
                <button class="button print-button" onclick="printDelayStats(${teacher.id})">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªØ§Ø®ÙŠØ±</button>
            </td>
        `;
        tbody.appendChild(row);
    });
}


// Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØºÙŠØ§Ø¨
function calculateAbsenceScore(absenceDays) {
    if (absenceDays === 0) return 5;
    if (absenceDays === 1) return 4;
    if (absenceDays === 2) return 3;
    if (absenceDays === 3) return 2;
    return 1; // 4 Ø£ÙŠØ§Ù… Ø£Ùˆ Ø£ÙƒØ«Ø±
}

// Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªØ£Ø®ÙŠØ±
function calculateDelayScore(delayMinutes) {
    if (delayMinutes < 420) return 5;      // Ø£Ù‚Ù„ Ù…Ù† 7 Ø³Ø§Ø¹Ø§Øª
    if (delayMinutes < 840) return 4;      // 7-14 Ø³Ø§Ø¹Ø©
    if (delayMinutes < 1260) return 3;     // 14-21 Ø³Ø§Ø¹Ø©
    if (delayMinutes < 1680) return 2;     // 21-28 Ø³Ø§Ø¹Ø©
    return 1;                              // Ø£ÙƒØ«Ø± Ù…Ù† 28 Ø³Ø§Ø¹Ø©
}

// ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ù„Ø© editTeacher
function editTeacher(id) {
    const row = document.querySelector(`tr[data-id="${id}"]`);
    const teacher = teachers.find(t => t.id === id);
    const absenceScore = calculateAbsenceScore(teacher.absenceDays);
    const delayScore = calculateDelayScore(teacher.delayMinutes);

    row.innerHTML = `
        <td>${teacher.id}</td>
        <td><input type="text" value="${teacher.name}" id="edit-name-${id}"></td>
        <td><input type="number" value="${teacher.absenceDays}" id="edit-absence-${id}"></td>
        <td class="rating-${absenceScore}">${absenceScore} Ù…Ù† 5</td>
        <td><input type="number" value="${teacher.delayMinutes}" id="edit-delay-${id}"></td>
        <td>${teacher.delayHours}</td>
        <td><input type="number" value="${teacher.delayDays}" id="edit-delayDays-${id}"></td>
        <td class="rating-${delayScore}">${delayScore} Ù…Ù† 5</td>
        <td class="rating-${teacher.rating}">${teacher.rating} Ù…Ù† 5</td>
        <td class="no-print">
            <button class="button save-button" onclick="saveTeacher(${id})">Ø­ÙØ¸</button>
            <button class="button delete-button" onclick="deleteTeacher(${id})">Ø­Ø°Ù</button>
        </td>
    `;
}



    // Ø­ÙØ¸ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù…
    function saveTeacher(id) {
    const name = document.getElementById(`edit-name-${id}`).value;
    const absenceDays = parseInt(document.getElementById(`edit-absence-${id}`).value) || 0;
    const delayMinutes = parseInt(document.getElementById(`edit-delay-${id}`).value) || 0;
    const delayDays = parseInt(document.getElementById(`edit-delayDays-${id}`).value) || 0;

    if (!name) {
        alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…');
        return;
    }

    const delayUnits = calculateDelayUnits(delayMinutes);
    const rating = calculateRating(absenceDays, delayMinutes);

    const teacherIndex = teachers.findIndex(t => t.id === id);
    teachers[teacherIndex] = {
        ...teachers[teacherIndex],
        name: name,
        absenceDays: absenceDays,
        delayMinutes: delayMinutes,
        delayHours: delayUnits.hours,
        delayDays: delayDays, // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹
        rating: rating
    };
    
    sortTeachersAlphabetically();
    updateTable();
    saveToLocalStorage();
}

    // Ø­Ø°Ù Ù…Ø¹Ù„Ù…
    function deleteTeacher(id) {
    if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¹Ù„Ù…ØŸ')) {
        teachers = teachers.filter(t => t.id !== id);
        updateTable(); // Ø³ÙŠÙØ¹ÙŠØ¯ ØªØ±Ù‚ÙŠÙ… Ø§Ù„ÙÙ‡Ø±Ø³ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
        saveToLocalStorage();
    }
}

    // Ø·Ø¨Ø§Ø¹Ø© Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØºÙŠØ§Ø¨
    function printAbsenceStats(id) {
    const teacher = teachers.find(t => t.id === id);
    const printWindow = window.open('', '', 'width=800,height=600');
    printWindow.document.write(`
        <html dir="rtl">
        <head>
            <title>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØºÙŠØ§Ø¨ - ${teacher.name}</title>
            <style>
                body { font-family: Arial; padding: 20px; }
                .stats { margin: 20px; }
                .header { text-align: center; }
                table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
                th { background-color: #f2f2f2; }
                .signatures {
                    margin-top: 50px;
                    display: flex;
                    justify-content: space-between;
                    padding: 20px;
                }
                .signature-box {
                    text-align: center;
                    width: 200px;
                }
                .signature-line {
                    border-top: 1px solid #000;
                    margin: 10px auto;
                    width: 150px;
                }
                .teacher-name {
                    text-align: right;
                    margin: 20px;
                    font-weight: bold;
                }
            </style>
        </head>
        <body>
            <div class="teacher-name">
                Ø§Ù„Ù…Ø¹Ù„Ù…: ${teacher.name}
            </div>
            <div class="header">
                <h2>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØºÙŠØ§Ø¨</h2>
                <p>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±: ${new Date().toLocaleDateString('ar-SA')}</p>
            </div>
            <table>
                <tr>
                    <th>Ø§Ù„Ù…Ø¹ÙŠØ§Ø±</th>
                    <th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th>
                </tr>
                <tr>
                    <td>Ø£ÙŠØ§Ù… Ø§Ù„ØºÙŠØ§Ø¨</td>
                    <td>${teacher.absenceDays}</td>
                </tr>
                <tr>
                    <td>Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</td>
                    <td>${teacher.rating} Ù…Ù† 5</td>
                </tr>
                <tr>
                    <td>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</td>
                    <td>${getAbsenceNote(teacher.absenceDays)}</td>
                </tr>
            </table>
            <div class="signatures">
    <div class="signature-box">
        <div>Ø§Ù„Ù…Ø¹Ù„Ù…</div>
        <div>${teacher.name}</div>
        <div>Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div>
        <div class="signature-line"></div>
    </div>
    <div class="signature-box">
        <div>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
        <div>Ù…Ø­Ù…Ø¯ Ø­Ø³ÙŠÙ† Ù…Ù†ØµÙˆØ± Ø­ÙˆØ°Ø§Ù†</div>
        <div>Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div>
        <div class="signature-line"></div>
    </div>
</div>
        </body>
        </html>
    `);
    printWindow.document.close();
    printWindow.print();
}

    // Ø·Ø¨Ø§Ø¹Ø© Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØ£Ø®ÙŠØ±
    // Ø·Ø¨Ø§Ø¹Ø© Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØ£Ø®ÙŠØ±
function printDelayStats(id) {
    const teacher = teachers.find(t => t.id === id);
    const printWindow = window.open('', '', 'width=800,height=600');
    printWindow.document.write(`
        <html dir="rtl">
        <head>
            <title>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØ£Ø®ÙŠØ± - ${teacher.name}</title>
            <style>
                body { font-family: Arial; padding: 20px; }
                .stats { margin: 20px; }
                .header { text-align: center; }
                table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
                th { background-color: #f2f2f2; }
                .signatures {
                    margin-top: 50px;
                    display: flex;
                    justify-content: space-between;
                    padding: 20px;
                }
                .signature-box {
                    text-align: center;
                    width: 200px;
                }
                .signature-line {
                    border-top: 1px solid #000;
                    margin: 10px auto;
                    width: 150px;
                }
                .teacher-name {
                    text-align: right;
                    margin: 20px;
                    font-weight: bold;
                }
                .note {
                    color: #444;
                    font-style: italic;
                    padding: 10px;
                    background-color: #f9f9f9;
                    border-radius: 4px;
                    margin-top: 20px;
                }
            </style>
        </head>
        <body>
            <div class="teacher-name">
                Ø§Ù„Ù…Ø¹Ù„Ù…: ${teacher.name}
            </div>
            <div class="header">
                <h2>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØ£Ø®ÙŠØ±</h2>
                <p>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±: ${new Date().toLocaleDateString('ar-SA')}</p>
            </div>
            <table>
                <tr>
                    <th>Ø§Ù„Ù…Ø¹ÙŠØ§Ø±</th>
                    <th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th>
                </tr>
                <tr>
                    <td>Ø¯Ù‚Ø§Ø¦Ù‚ Ø§Ù„ØªØ£Ø®ÙŠØ±</td>
                    <td>${teacher.delayMinutes}</td>
                </tr>
                <tr>
                    <td>Ø³Ø§Ø¹Ø§Øª Ø§Ù„ØªØ£Ø®ÙŠØ±</td>
                    <td>${teacher.delayHours}</td>
                </tr>
                <tr>
                    <td>Ø£ÙŠØ§Ù… Ø§Ù„ØªØ£Ø®ÙŠØ±</td>
                    <td>${teacher.delayDays}</td>
                </tr>
                <tr>
                    <td>Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</td>
                    <td>${teacher.rating} Ù…Ù† 5</td>
                </tr>
                <tr>
                    <td>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</td>
                    <td>${getDelayNote(teacher.delayMinutes)}</td>
                </tr>
            </table>
            <div class="signatures">
    <div class="signature-box">
        <div>Ø§Ù„Ù…Ø¹Ù„Ù…</div>
        <div>${teacher.name}</div>
        <div>Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div>
        <div class="signature-line"></div>
    </div>
    <div class="signature-box">
        <div>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
        <div>Ù…Ø­Ù…Ø¯ Ø­Ø³ÙŠÙ† Ù…Ù†ØµÙˆØ± Ø­ÙˆØ°Ø§Ù†</div>
        <div>Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div>
        <div class="signature-line"></div>
    </div>
</div>
        </body>
        </html>
    `);
    printWindow.document.close();
    printWindow.print();
}


    // Ø·Ø¨Ø§Ø¹Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
    function printAllStats() {
        const printWindow = window.open('', '', 'width=800,height=600');
        printWindow.document.write(`
            <html dir="rtl">
            <head>
                <title>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†</title>
                <style>
                    body { font-family: Arial; padding: 20px; }
                    table { width: 100%; border-collapse: collapse; }
                    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
                    th { background-color: #f2f2f2; }
                    .header { text-align: center; }
                </style>
            </head>
            <body>
                <div class="header">
                    <h2>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†</h2>
                    <p>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±: ${new Date().toLocaleDateString('ar-SA')}</p>
                </div>
                <table>
                    <tr>
                        <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</th>
                        <th>Ø§Ù„ØºÙŠØ§Ø¨ (Ø£ÙŠØ§Ù…)</th>
                        <th>ØªØ£Ø®ÙŠØ± (Ø¯Ù‚Ø§Ø¦Ù‚)</th>
                        <th>ØªØ£Ø®ÙŠØ± (Ø³Ø§Ø¹Ø§Øª)</th>
                        <th>ØªØ£Ø®ÙŠØ± (Ø£ÙŠØ§Ù…)</th>
                        <th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</th>
                    </tr>
                    ${teachers.map(t => `
                        <tr>
                            <td>${t.name}</td>
                            <td>${t.absenceDays}</td>
                            <td>${t.delayMinutes}</td>
                            <td>${t.delayHours}</td>
                            <td>${t.delayDays}</td>
                            <td>${t.rating} Ù…Ù† 5</td>
                        </tr>
                    `).join('')}
                </table>
            </body>
            </html>
        `);
        printWindow.document.close();
        printWindow.print();
    }

    // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    function exportToJSON() {
        const dataStr = JSON.stringify(teachers, null, 2);
        const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
        const exportFileDefaultName = 'teachers-data.json';

        const linkElement = document.createElement('a');
        linkElement.setAttribute('href', dataUri);
        linkElement.setAttribute('download', exportFileDefaultName);
        linkElement.click();
    }

    // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    function importFromJSON() {
    const file = document.getElementById('importFile').files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const importedData = JSON.parse(e.target.result);
                teachers = importedData;
                counter = Math.max(...teachers.map(t => t.id), 0) + 1; // Ø¥ØµÙ„Ø§Ø­ Ù‡Ù†Ø§
                updateTable();
                saveToLocalStorage();
                alert('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
            } catch (error) {
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù„Ù');
            }
        };
        reader.readAsText(file);
    }
}

    // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„
    function clearInputs() {
        document.getElementById('teacherName').value = '';
        document.getElementById('absenceDays').value = '';
        document.getElementById('delayMinutes').value = '';
    }

    // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª
    function getAbsenceNote(days) {
        if (days === 0) return "Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØºÙŠØ§Ø¨ - Ù…Ù…ØªØ§Ø²";
        else if (days === 1) return "ØºÙŠØ§Ø¨ Ù…Ù‚Ø¨ÙˆÙ„";
        else if (days === 2) return "ØºÙŠØ§Ø¨ Ù…ØªÙˆØ³Ø· - ÙŠØ­ØªØ§Ø¬ Ù…ØªØ§Ø¨Ø¹Ø©";
        else if (days === 3) return "ØºÙŠØ§Ø¨ ÙƒØ«ÙŠØ± - ÙŠØ³ØªØ¯Ø¹ÙŠ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©";
        else return "ØºÙŠØ§Ø¨ Ù…Ø±ØªÙØ¹ Ø¬Ø¯Ø§Ù‹ - ÙŠØªØ·Ù„Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ ÙÙˆØ±ÙŠ";
    }
// Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ØªØ£Ø®ÙŠØ±
function getDelayNote(minutes) {
    if (minutes < 420) return "Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ£Ø®ÙŠØ± ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… - Ù…Ù…ØªØ§Ø²";
    else if (minutes < 840) return "ØªØ£Ø®ÙŠØ± 7 Ø³Ø§Ø¹Ø§Øª - ØªÙ‚ÙŠÙŠÙ… 4 Ù…Ù† 5";
    else if (minutes < 1260) return "ØªØ£Ø®ÙŠØ± 14 Ø³Ø§Ø¹Ø© - ØªÙ‚ÙŠÙŠÙ… 3 Ù…Ù† 5";
    else if (minutes < 1680) return "ØªØ£Ø®ÙŠØ± 21 Ø³Ø§Ø¹Ø© - ØªÙ‚ÙŠÙŠÙ… 2 Ù…Ù† 5";
    else return "ØªØ£Ø®ÙŠØ± Ø£ÙƒØ«Ø± Ù…Ù† 28 Ø³Ø§Ø¹Ø© - ØªÙ‚ÙŠÙŠÙ… 1 Ù…Ù† 5";
}


function importNamesFromMain() {
    const mainData = localStorage.getItem('teachersStats');
    
    if (!mainData) {
        alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©');
        return;
    }
    
    try {
        const teachersFromMain = JSON.parse(mainData);
        const existingNames = teachers.map(t => t.name);
        
        teachersFromMain.forEach(teacher => {
            if (!existingNames.includes(teacher.name)) {
                teachers.push({
                    id: counter++,
                    name: teacher.name,
                    absenceDays: 0,
                    delayMinutes: 0,
                    delayHours: 0,
                    delayDays: 0,
                    rating: 5
                });
            }
        });
        
        updateTable();
        saveToLocalStorage();
        alert(`ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${teachersFromMain.length} Ø§Ø³Ù… Ø¨Ù†Ø¬Ø§Ø­`);
    } catch (error) {
        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        console.error(error);
    }
}



    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    window.onload = function() {
        loadFromLocalStorage();
        if (teachers.length === 0) {
            const defaultTeachers = [
                { name: "Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ", absenceDays: 2, delayMinutes: 40 },
                { name: "Ø£Ø­Ù…Ø¯ Ø®Ø§Ù„Ø¯", absenceDays: 1, delayMinutes: 30 },
                { name: "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø³Ø¹ÙŠØ¯", absenceDays: 0, delayMinutes: 10 }
            ];

            defaultTeachers.forEach(teacher => {
                document.getElementById('teacherName').value = teacher.name;
                document.getElementById('absenceDays').value = teacher.absenceDays;
                document.getElementById('delayMinutes').value = teacher.delayMinutes;
                addTeacher();
            });
        }
    };
window.onload = function() {
        loadFromLocalStorage();
        showInstructions();
    };
// Ø¯Ø§Ù„Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù… ÙÙ‚Ø·
function editTeacherName(id) {
    const teacher = teachers.find(t => t.id === id);
    
    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø±Ø¨Ø¹ Ø­ÙˆØ§Ø± Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
    const newName = prompt("ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…", teacher.name);
    
    if (newName !== null) {  // Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¶ØºØ· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù„Ù‰ Ø¥Ù„ØºØ§Ø¡
        if (!newName.trim()) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…');
            return;
        }
        
        const teacherIndex = teachers.findIndex(t => t.id === id);
        teachers[teacherIndex].name = newName;
        
        sortTeachersAlphabetically();
        updateTable();
        saveToLocalStorage();
    }
}

</script>
</body>
</html>
